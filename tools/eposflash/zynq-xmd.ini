set app /home/jgreis/svn/epos/epos2/branches/merge/cortex_a/img/concurrent_philosophers_dinner.img
set gdb 0
set bit empty
set pbin empty

set empty empty

# Connect to the board through JTAG
connect arm hw

# Configure the FPGA if empty was set
if {$bit!=$empty} {
    fpga -f $bit
}

# ps7_init.tcl provides functions to initialize the DDR controller and other
# peripherals to a default state, it's generated by Vivado
set path [file dirname [file normalize [info script]]]
source $path/zynq-ps7_init.tcl
ps7_init
ps7_post_config

# Download ELF file to Zynq's memory
dow $app

# Download partial binary bitstream if empty was set
if {$pbin!=$empty} {
    dow -data $pbin 0x01000000
}

# Don't continue if 0 is attached
if {$gdb=="0"} {
    con
}
